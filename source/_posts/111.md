---
title: D3.js基础
date: 2025-8-11
categories:
   - 前端进阶
---

### 安装依赖包

```shell
npm install d3
```



### 基础图形绘制

导入：

```javascript
import * as d3 from 'd3';
```



#### 1. 矩形

```javascript
const svg = d3.select('.d3-box').append('svg').attr('width', 200).attr('height', 200);

svg.append('rect').attr('x', 120).attr('y', 60).attr('width', 80).attr('height', 50).style('fill', 'black');
```



#### 2. 圆形

```javascript
const svg = d3.select('.d3-box').append('svg').attr('width', 200).attr('height', 200);

svg.append('circle').attr('cx', 100).attr('cy', 100).attr('r', 50).style('fill', 'black');
```

圆形可以通过`<circle>` SVG元素来创建，需要设置`cx`, `cy`（圆心坐标）和`r`（半径）属性



#### 3. 多边形

```javascript
const svg = d3.select('.d3-box').append('svg').attr('width', 200).attr('height', 200);

svg.append('polygon')
    .attr('points', '10,10 100,10 80,100 10,60')
    .style('fill', 'black');
```



## 创建图表

#### 1. 柱状图

```javascript
// 定义尺寸大小
const margin = { top: 50, right: 50, bottom: 70, left: 70 };
const width = 800 - margin.left - margin.right;
const height = 400 - margin.top - margin.bottom;

// 创建svg
const container = d3.select('.d3-box');
const svg = container
.append('svg')
.attr('width', width + margin.left + margin.right)
.attr('height', height + margin.top + margin.bottom)
.append('g')
.attr('transform', `translate(${margin.left}, ${margin.top})`);

const data = [
    { category: 'A', value: 30 },
    { category: 'B', value: 85 },
    { category: 'C', value: 60 },
    { category: 'D', value: 45 },
    { category: 'E', value: 75 },
    { category: 'F', value: 50 }
];

// X轴比例尺
const x = d3
.scaleBand()
.domain(data.map(d => d.category))
.range([0, width])
.padding(0.2);

// Y轴比例尺
const y = d3
.scaleLinear()
.domain([0, d3.max(data, d => d.value) * 1.1])
.range([height, 0]);

// 添加X轴
svg.append('g').attr('transform', `translate(0, ${height})`).call(d3.axisBottom(x)).selectAll('text');

// 添加Y轴
svg.append('g').call(d3.axisLeft(y).ticks(5));

// 添加X轴标签
svg.append('text')
    .attr('x', width / 2)
    .attr('y', height + 50)
    .attr('text-anchor', 'middle')
    .text('类别');

// 添加Y轴标签
svg.append('text')
    .attr('transform', 'rotate(-90)')
    .attr('x', -height / 2)
    .attr('y', -50)
    .attr('text-anchor', 'middle')
    .text('数值');

// 添加标题
svg.append('text')
    .attr('x', width / 2)
    .attr('y', -15)
    .attr('text-anchor', 'middle')
    .text('柱状图示例');

// 创建柱状图
svg.selectAll('.bar')
    .data(data)
    .enter()
    .append('rect')
    .attr('class', 'bar')
    .attr('x', d => x(d.category))
    .attr('y', d => y(d.value))
    .attr('width', x.bandwidth())
    .attr('height', d => height - y(d.value))
    .attr('fill', (d, i) => '#4e89ae');

// 添加数据标签
svg.selectAll('.data-label')
    .data(data)
    .enter()
    .append('text')
    .attr('class', 'data-label')
    .attr('x', d => x(d.category) + x.bandwidth() / 2 - 6)
    .attr('y', d => y(d.value) - 10)
    .text(d => d.value);
```

