---
title: ç½‘é¡µæ¸¸æˆåˆ¶ä½œï¼Œphaseråˆ¶ä½œ4399å°æ¸¸æˆ
date: 2024-10-09
tags:
   - phaser
categories:
   - å‰ç«¯è¿›é˜¶
---

## å‰è¨€

ç›¸ä¿¡å®¶äººä»¬éƒ½ç©è¿‡4399å°æ¸¸æˆå§ï¼Œé‚£ä½ ä¼šä¸ä¼šå¥½å¥‡ï¼Œå¦‚ä½•åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­åšä¸€æ¬¾å°æ¸¸æˆå‘¢ï¼Œè¿™é‡Œä½œè€…å°±ç”¨phaseræ¥æ•™å¤§å®¶å¦‚ä½•æ§åˆ¶è§’è‰²ä¸Šä¸‹å·¦å³ç§»åŠ¨

phaserå®˜ç½‘ï¼š[Phaser - A fast, fun and free open source HTML5 game framework](https://phaser.io/)
æ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±æ·±å…¥ç ”ç©¶å­¦ä¹ å“¦ï¼Œè¿™é‡Œä½œè€…åªåšä¸€ä¸ªåŸºç¡€çš„è§’è‰²æ§åˆ¶æ¼”ç¤º

å¤§å®¶åå¥½ï¼Œå‡†å¤‡å‘è½¦äº†ï¼

![å›¾ç‰‡](https://pic.imgdb.cn/item/671256c8d29ded1a8ce3a11c.webp)

## é¢„è§ˆ

![å›¾ç‰‡](https://pic.imgdb.cn/item/671256c8d29ded1a8ce3a134.webp)

## phaserç¯å¢ƒæ­å»º

è¿™é‡Œä½œè€…å°±ä¸ç”¨npmäº†ï¼Œç›´æ¥å¼•å…¥çš„cdn

`<script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.85.1/phaser.min.js"></script>`

è¿™æ ·æ²¡æœ‰ä»£ç æç¤ºï¼ˆæœ‰æ²¡æœ‰å¤§ä½¬çŸ¥é“ä»£ç æç¤ºæ’ä»¶çš„ï¼Œå¸‚é¢ä¸Šçš„æ’ä»¶å¥½åƒéƒ½æœ‰bugï¼Œå¯èƒ½å¤ªä¹…æ²¡æ›´æ–°äº†ğŸ¤”ï¼‰ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨npmï¼Œä½œè€…å°±æ˜¯å›¾ä¸ªæ–¹ä¾¿ï¼Œå¥½äº†åºŸè¯ä¸è¯´äº†ï¼Œåæ­£ç¯å¢ƒæ­å»ºéå¸¸ç®€å•ï¼Œä½ éšä¾¿å‘æŒ¥ï¼Œå“ˆå“ˆå“ˆå“ˆ

## ç´ æå‡†å¤‡

è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¸€å¼ å®å¯æ¢¦ä¸­è§’è‰²çš„ç²¾çµå›¾ï¼ˆä»å°å°±å–œæ¬¢ï¼‰ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥ç›´æ¥è‡ªå·±éšä¾¿æ‰¾ä¸€å¼ è¿™ç§å…³é”®å¸§çš„ç²¾çµå›¾ï¼Œæƒ³è¦ä½œè€…çš„ç´ æçš„ï¼Œæˆ‘ä¹Ÿéå¸¸è´´å¿ƒçš„ä¸Šä¼ äº†ï¼ˆä»…ä¾›å­¦ä¹ ä½¿ç”¨ï¼‰ï¼š

é“¾æ¥:<https://pan.baidu.com/s/1WeJ1H_dX_xZDvLqXJrLf4wÂ >
æå–ç :dj8m

## æ¸¸æˆåœºæ™¯åˆå§‹åŒ–

```js
const config = {
            type: Phaser.AUTO,
            width: window.innerWidth,
            height: window.innerHeight,
            parent: 'game',
            backgroundColor: '#efefef',
            scene: {
                preload: preload,
                create: create,
                update: update
            },
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: false
                },
            }
        };

        const game = new Phaser.Game(config);
```

configå±æ€§è¯´æ˜ï¼š

1.  type: æŒ‡å®šæ¸²æŸ“å™¨ç±»å‹ã€‚`Phaser.AUTO`Â ä¼šè‡ªåŠ¨é€‰æ‹©æœ€é€‚åˆçš„æ¸²æŸ“æ–¹å¼ï¼ˆé€šå¸¸æ˜¯WebGLï¼Œå¦‚æœæµè§ˆå™¨ä¸æ”¯æŒåˆ™å›é€€åˆ°Canvasï¼‰
2.  parent: æŒ‡å®šä¸€ä¸ªDOMå…ƒç´ IDï¼Œä½œä¸ºæ¸¸æˆç”»å¸ƒçš„çˆ¶å®¹å™¨
3.  scene: å®šä¹‰äº†åœºæ™¯ç›¸å…³çš„é…ç½®ï¼ŒåŒ…æ‹¬é¢„åŠ è½½èµ„æºã€åˆ›å»ºæ¸¸æˆä¸–ç•Œå’Œæ›´æ–°é€»è¾‘çš„æ–¹æ³•
    *   preload: ç”¨äºåŠ è½½æ¸¸æˆæ‰€éœ€çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€éŸ³é¢‘ç­‰ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªå‡½æ•°å¼•ç”¨ï¼Œå®é™…çš„åŠ è½½é€»è¾‘éœ€è¦åœ¨å¯¹åº”çš„å‡½æ•°ä¸­å®ç°
    *   create: åœ¨è¿™ä¸ªé˜¶æ®µï¼Œä½ å¯ä»¥åˆå§‹åŒ–æ¸¸æˆå¯¹è±¡ã€è®¾ç½®åˆå§‹çŠ¶æ€ç­‰
    *   update: æ¸¸æˆå¾ªç¯ä¸­çš„æ¯ä¸€å¸§éƒ½ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚é€šå¸¸åœ¨è¿™é‡Œå¤„ç†æ¸¸æˆé€»è¾‘ã€ç‰©ç†æ¨¡æ‹Ÿã€ç©å®¶è¾“å…¥ç­‰
4.  physics: é…ç½®ç‰©ç†å¼•æ“ç›¸å…³é€‰é¡¹
    *   default: æŒ‡å®šé»˜è®¤ä½¿ç”¨çš„ç‰©ç†å¼•æ“ã€‚è¿™é‡Œè®¾ç½®ä¸º`'arcade'`ï¼Œå³Phaserå†…ç½®çš„ç®€åŒ–ç‰ˆç‰©ç†å¼•æ“
    *   arcade: è¿›ä¸€æ­¥é…ç½®Arcadeç‰©ç†å¼•æ“çš„è¡Œä¸º,gravityè®¾ç½®ä¸ºfalseè¡¨ç¤ºç¦ç”¨å…¨å±€é‡åŠ›

## preloadå‡½æ•°

è¿™é‡Œä¸»è¦æ˜¯åŠ è½½èµ„æºæ–‡ä»¶

```js
function preload() {
    this.load.spritesheet({
        key: 'role',
        url: 'assets/role.png',
        frameConfig: {
            frameWidth: 64,
            frameHeight: 64,
        }
    });

}
```

è¯´æ˜:

1.  key: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½œä¸ºè¿™ä¸ªç²¾çµå›¾çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚åœ¨æ¸¸æˆçš„å…¶ä»–éƒ¨åˆ†ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªé”®æ¥å¼•ç”¨è¿™ä¸ªç²¾çµå›¾
2.  frameConfig: è¿™ä¸ªå¯¹è±¡å®šä¹‰äº†ç²¾çµå›¾ä¸­æ¯ä¸ªå¸§ï¼ˆå³æ¯ä¸ªå°å›¾ç‰‡ï¼‰çš„å°ºå¯¸ã€‚è¿™å¯¹äºæ­£ç¡®è§£æå’Œæ˜¾ç¤ºç²¾çµå›¾ä¸­çš„å„ä¸ªéƒ¨åˆ†éå¸¸é‡è¦

## create

è¿™é‡Œåšçš„å°±æ˜¯å°†èµ„æºè¿›è¡Œè§£æï¼Œå˜æˆä¸€ä¸ªä¸€ä¸ªçš„ç²¾çµåŠ¨ç”»ï¼Œå°±æ˜¯è§’è‰²ä¸Šä¸‹å·¦å³ç§»åŠ¨çš„åŠ¨ç”»

```js
function create() {
    player = this.physics.add.sprite(window.innerWidth / 2, window.innerHeight / 2, 'role');
    player.setCollideWorldBounds(true);

    this.anims.create({
        key: 'up',
        frames: this.anims.generateFrameNumbers('role', { start: 0, end: 2 }),
        frameRate: 10,
        repeat: -1
    });

    this.anims.create({
        key: 'right',
        frames: this.anims.generateFrameNumbers('role', { start: 4, end: 6 }),
        frameRate: 10,
        repeat: -1
    });

    this.anims.create({
        key: 'down',
        frames: this.anims.generateFrameNumbers('role', { start: 8, end: 10 }),
        frameRate: 10,
        repeat: -1
    });

    this.anims.create({
        key: 'left',
        frames: this.anims.generateFrameNumbers('role', { start: 12, end: 14 }),
        frameRate: 10,
        repeat: -1
    });

    this.anims.create({
        key: 'idle_up',
        frames: [{ key: 'role', frame: 1 }],
        frameRate: 20
    });

    this.anims.create({
        key: 'idle_right',
        frames: [{ key: 'role', frame: 5 }],
        frameRate: 20
    });

    this.anims.create({
        key: 'idle_down',
        frames: [{ key: 'role', frame: 9 }],
        frameRate: 20
    });

    this.anims.create({
        key: 'idle_left',
        frames: [{ key: 'role', frame: 13 }],
        frameRate: 20
    });
}

```

è¯´æ˜:

1.  `this.physics.add.sprite(x, y, textureKey)`: åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ç‰©ç†å±æ€§çš„ç²¾çµã€‚`x`Â å’ŒÂ `y`Â æ˜¯ç²¾çµçš„åˆå§‹ä½ç½®ï¼Œè¿™é‡Œè®¾ç½®ä¸ºçª—å£å®½åº¦å’Œé«˜åº¦çš„ä¸€åŠï¼Œä½¿è§’è‰²å±…ä¸­æ˜¾ç¤ºã€‚`textureKey`Â æ˜¯åœ¨Â `preload`Â ä¸­åŠ è½½çš„ç²¾çµå›¾çš„é”®å
2.  `player.setCollideWorldBounds(true)`: è®¾ç½®ç©å®¶è§’è‰²ä¸ä¸–ç•Œè¾¹ç•Œç¢°æ’æ—¶çš„è¡Œä¸ºã€‚`true`Â è¡¨ç¤ºå½“ç©å®¶è§’è‰²ç¢°åˆ°ä¸–ç•Œè¾¹ç•Œæ—¶ä¼šåœæ­¢ç§»åŠ¨ã€‚
3.  `this.anims.create(config)`: åˆ›å»ºä¸€ä¸ªæ–°çš„åŠ¨ç”»
4.  `frames`: å®šä¹‰åŠ¨ç”»å¸§ã€‚ä½¿ç”¨Â `this.anims.generateFrameNumbers`Â æ–¹æ³•æ¥ç”Ÿæˆä¸€ç³»åˆ—å¸§ç¼–å·ã€‚`start`Â å’ŒÂ `end`Â å‚æ•°æŒ‡å®šäº†èµ·å§‹å¸§å’Œç»“æŸå¸§çš„ç´¢å¼•ã€‚ä¾‹å¦‚ï¼Œ`{ start: 0, end: 2 }`Â è¡¨ç¤ºä»ç¬¬0å¸§åˆ°ç¬¬2å¸§
5.  `frameRate`: æ¯ç§’æ’­æ”¾çš„å¸§æ•°ã€‚è¿™é‡Œè®¾ç½®ä¸ºÂ `10`ï¼Œæ„å‘³ç€æ¯ç§’æ’­æ”¾10å¸§
6.  `repeat`: åŠ¨ç”»æ˜¯å¦é‡å¤æ’­æ”¾ã€‚`-1`Â è¡¨ç¤ºæ— é™å¾ªç¯

## updateå‡½æ•°

è¿™é‡Œå°±æ˜¯æ§åˆ¶åŠ¨ç”»å¦‚ä½•è¿è¡Œçš„ï¼Œæ¯”å¦‚äººç‰©æŒ‰ä¸‹å“ªä¸ªé”®å‘ä¸Šç§»åŠ¨ç­‰æ“ä½œ

```js
// æŒ‚æœºæ—¶äººç‰©çš„æœå‘
let action_type = 'idle_down'
// è§’è‰²çš„ç§»åŠ¨é€Ÿåº¦
const velocity = 160
function update() {
    const cursors = this.input.keyboard.createCursorKeys();
    // é»˜è®¤æƒ…å†µä¸‹ï¼Œåœæ­¢æ‰€æœ‰æ–¹å‘ä¸Šçš„è¿åŠ¨
    player.setVelocityX(0);
    player.setVelocityY(0);
    switch (true) {
        case cursors.up.isDown:
            player.anims.play('up', true);
            player.setVelocityY(-velocity);
            action_type = 'idle_up'
            break;
        case cursors.right.isDown:
            player.anims.play('right', true);
            player.setVelocityX(velocity);
            action_type = 'idle_right'
            break;
        case cursors.down.isDown:
            player.anims.play('down', true);
            player.setVelocityY(velocity);
            action_type = 'idle_down'
            break;
        case cursors.left.isDown:
            player.anims.play('left', true);
            player.setVelocityX(-velocity);
            action_type = 'idle_left'
            break;
        default:
            player.anims.play(action_type, true);
    }
}
```

## å®Œæ•´ä»£ç 

```html
<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.85.1/phaser.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #game {
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <div id="game"></div>
    <script>
        const config = {
            type: Phaser.AUTO,
            width: window.innerWidth,
            height: window.innerHeight,
            parent: 'game',
            backgroundColor: '#efefef',
            scene: {
                preload: preload,
                create: create,
                update: update
            },
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: false
                },
            }
        };

        const game = new Phaser.Game(config);

        function preload() {
            this.load.spritesheet({
                key: 'role',
                url: 'assets/role.png',
                frameConfig: {
                    frameWidth: 64,
                    frameHeight: 64,
                }
            });

        }

        function create() {
            player = this.physics.add.sprite(window.innerWidth / 2, window.innerHeight / 2, 'role');
            player.setCollideWorldBounds(true);

            this.anims.create({
                key: 'up',
                frames: this.anims.generateFrameNumbers('role', { start: 0, end: 2 }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: 'right',
                frames: this.anims.generateFrameNumbers('role', { start: 4, end: 6 }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: 'down',
                frames: this.anims.generateFrameNumbers('role', { start: 8, end: 10 }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: 'left',
                frames: this.anims.generateFrameNumbers('role', { start: 12, end: 14 }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: 'idle_up',
                frames: [{ key: 'role', frame: 1 }],
                frameRate: 20
            });

            this.anims.create({
                key: 'idle_right',
                frames: [{ key: 'role', frame: 5 }],
                frameRate: 20
            });

            this.anims.create({
                key: 'idle_down',
                frames: [{ key: 'role', frame: 9 }],
                frameRate: 20
            });

            this.anims.create({
                key: 'idle_left',
                frames: [{ key: 'role', frame: 13 }],
                frameRate: 20
            });
        }

        let action_type = 'idle_down'
        // è§’è‰²çš„ç§»åŠ¨é€Ÿåº¦
        const velocity = 160
        function update() {
            const cursors = this.input.keyboard.createCursorKeys();
            // é»˜è®¤æƒ…å†µä¸‹ï¼Œåœæ­¢æ‰€æœ‰æ–¹å‘ä¸Šçš„è¿åŠ¨
            player.setVelocityX(0);
            player.setVelocityY(0);
            switch (true) {
                case cursors.up.isDown:
                    player.anims.play('up', true);
                    player.setVelocityY(-velocity);
                    action_type = 'idle_up'
                    break;
                case cursors.right.isDown:
                    player.anims.play('right', true);
                    player.setVelocityX(velocity);
                    action_type = 'idle_right'
                    break;
                case cursors.down.isDown:
                    player.anims.play('down', true);
                    player.setVelocityY(velocity);
                    action_type = 'idle_down'
                    break;
                case cursors.left.isDown:
                    player.anims.play('left', true);
                    player.setVelocityX(-velocity);
                    action_type = 'idle_left'
                    break;
                default:
                    player.anims.play(action_type, true);
            }
        }
    </script>
</body>

</html>
```
